services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      target: development
    environment:
      NODE_ENV: development
      PORT: 3000
      MONGODB_URI: mongodb://${MONGO_ROOT_USERNAME:-scheduler}:${MONGO_ROOT_PASSWORD:-change-me}@mongo:27017/${MONGO_DB_NAME:-smart_schedule}?authSource=admin
      JWT_SECRET: ${JWT_SECRET:-dev-secret-change-this}
      USE_ETHEREAL: ${USE_ETHEREAL:-true}
      CLIENT_URL: ${CLIENT_URL:-http://localhost:5173}
      ENABLE_NOTIFY: ${ENABLE_NOTIFY:-false}
      MAIL_HOST: ${MAIL_HOST:-}
      MAIL_PORT: ${MAIL_PORT:-}
      MAIL_USER: ${MAIL_USER:-}
      MAIL_PASS: ${MAIL_PASS:-}
      MAIL_FROM: ${MAIL_FROM:-}
      EMAIL_USER: ${EMAIL_USER:-}
      EMAIL_PASS: ${EMAIL_PASS:-}
      TWILIO_ACCOUNT_SID: ${TWILIO_ACCOUNT_SID:-}
      TWILIO_AUTH_TOKEN: ${TWILIO_AUTH_TOKEN:-}
      TWILIO_FROM: ${TWILIO_FROM:-}
    command: npm run dev
    volumes:
      - .:/app
      - app_node_modules:/app/node_modules
      - uploads_data:/app/uploads

volumes:
  app_node_modules:
